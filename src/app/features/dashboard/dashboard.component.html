<!-- src/app/features/dashboard/dashboard.component.html -->

<div class="dashboard-container">

  <!-- Header de Bienvenida -->
  <section class="welcome-section">
    <div class="welcome-card">
      <div class="welcome-content">
        <div class="welcome-info">
          <div class="greeting">
            <h1>Â¡Bienvenido de vuelta! ðŸ‘‹</h1>
            <p class="user-subtitle">{{ userName() }} â€¢ {{ companyName() }}</p>
          </div>
          <div class="current-time">
            <div class="time-info">
              <span class="day">{{ getCurrentDay() }}</span>
              <span class="date">{{ getCurrentDate() }}</span>
            </div>
          </div>
        </div>

        <div class="welcome-avatar">
          <div class="avatar-circle">
            <span class="avatar-text">{{ userInitials() }}</span>
          </div>
          <div class="status-indicator online"></div>
        </div>
      </div>

      <!-- Quick Stats en el header -->
      <div class="header-stats">
        <div class="quick-stat">
          <span class="stat-label">Activos Hoy</span>
          <span class="stat-value">{{ getActiveToday() }}</span>
        </div>
        <div class="quick-stat">
          <span class="stat-label">Alertas</span>
          <span class="stat-value">{{ getAlerts() }}</span>
        </div>
        <div class="quick-stat">
          <span class="stat-label">Eficiencia</span>
          <span class="stat-value">{{ getEfficiency() }}%</span>
        </div>
      </div>
    </div>
  </section>

  <!-- EstadÃ­sticas Principales -->
  <section class="stats-section">
    <h2 class="section-title">
      <mat-icon>analytics</mat-icon>
      Panel de Control
    </h2>

    <div class="stats-grid">
      <div
        *ngFor="let stat of statsCards()"
        class="stat-card"
        (click)="onStatClick(stat)"
        matRipple
        [matRippleColor]="stat.color + '20'">

        <div class="stat-background" [style.background]="stat.bgGradient"></div>

        <div class="stat-header">
          <div class="stat-icon" [style.color]="stat.color">
            <mat-icon>{{ stat.icon }}</mat-icon>
          </div>
          <div class="stat-change" [class]="getChangeClass(stat.changeType)">
            <mat-icon>{{ stat.changeType === 'positive' ? 'trending_up' : 'trending_down' }}</mat-icon>
            {{ stat.change }}
          </div>
        </div>

        <div class="stat-content">
          <h3 class="stat-title">{{ stat.title }}</h3>
          <p class="stat-value">{{ stat.value }}</p>
          <span class="stat-description">{{ stat.description }}</span>
        </div>

        <div class="stat-footer">
          <button mat-icon-button class="view-details-btn">
            <mat-icon>arrow_forward</mat-icon>
          </button>
        </div>
      </div>
    </div>
  </section>

  <!-- Grid de Contenido Principal -->
  <div class="main-grid">

    <!-- Acciones RÃ¡pidas -->
    <section class="quick-actions-section">
      <h2 class="section-title">
        <mat-icon>flash_on</mat-icon>
        Acciones RÃ¡pidas
      </h2>

      <div class="actions-grid">
        <div
          *ngFor="let action of quickActions()"
          class="action-card"
          (click)="onQuickAction(action)"
          matRipple
          [matRippleColor]="action.color + '30'">

          <div class="action-background" [style.background]="action.bgGradient"></div>

          <div class="action-header">
            <div class="action-icon" [style.color]="action.color">
              <mat-icon>{{ action.icon }}</mat-icon>
            </div>
            <button mat-icon-button class="action-menu">
              <mat-icon>more_vert</mat-icon>
            </button>
          </div>

          <div class="action-content">
            <h3 class="action-title">{{ action.title }}</h3>
            <p class="action-description">{{ action.description }}</p>
          </div>

          <div class="action-footer">
            <button mat-button [style.color]="action.color" class="action-btn">
              Ir a {{ action.title.split(' ')[0] }}
              <mat-icon>arrow_forward</mat-icon>
            </button>
          </div>
        </div>
      </div>
    </section>

    <!-- Actividad Reciente -->
    <section class="activity-section">
      <h2 class="section-title">
        <mat-icon>timeline</mat-icon>
        Actividad Reciente
      </h2>

      <div class="activity-card">
        <div class="activity-list">
          <div
            *ngFor="let activity of recentActivity(); let i = index"
            class="activity-item"
            [style.animation-delay]="i * 0.1 + 's'">

            <div class="activity-avatar" [class]="getActivityClass(activity.type)">
              <mat-icon>{{ getActivityIcon(activity.type) }}</mat-icon>
            </div>

            <div class="activity-content">
              <div class="activity-main">
                <span class="activity-user">{{ activity.user }}</span>
                <span class="activity-action">{{ activity.action }}</span>
              </div>
              <span class="activity-time">{{ activity.time }}</span>
            </div>

            <button mat-icon-button class="activity-details">
              <mat-icon>chevron_right</mat-icon>
            </button>
          </div>
        </div>

        <div class="activity-footer">
          <button mat-button class="view-all-btn">
            <mat-icon>history</mat-icon>
            Ver todo el historial
          </button>
        </div>
      </div>
    </section>

    <!-- Panel de Estado del Sistema -->
    <section class="system-status-section">
      <h2 class="section-title">
        <mat-icon>monitor_heart</mat-icon>
        Estado del Sistema
      </h2>

      <div class="status-card">
        <div class="status-items">
          <div class="status-item">
            <div class="status-indicator online"></div>
            <div class="status-info">
              <span class="status-label">API Server</span>
              <span class="status-value">Conectado</span>
            </div>
          </div>

          <div class="status-item">
            <div class="status-indicator online"></div>
            <div class="status-info">
              <span class="status-label">Base de Datos</span>
              <span class="status-value">Operativa</span>
            </div>
          </div>

          <div class="status-item">
            <div class="status-indicator warning"></div>
            <div class="status-info">
              <span class="status-label">GPS Service</span>
              <span class="status-value">Latencia Alta</span>
            </div>
          </div>
        </div>

        <div class="system-info">
          <div class="info-row">
            <span class="info-label">Ãšltima actualizaciÃ³n:</span>
            <span class="info-value">{{ getLastUpdate() }}</span>
          </div>
          <div class="info-row">
            <span class="info-label">Token vÃ¡lido hasta:</span>
            <span class="info-value">{{ getTokenExpiry() }}</span>
          </div>
        </div>
      </div>
    </section>

  </div>

  <!-- Footer del Dashboard -->
  <section class="dashboard-footer">
    <div class="footer-content">
      <div class="footer-info">
        <span>Sistema de GeolocalizaciÃ³n v2.1.0</span>
        <span>â€¢</span>
        <span>{{ companyName() }}</span>
      </div>
      <div class="footer-actions">
        <button mat-button>
          <mat-icon>help</mat-icon>
          Ayuda
        </button>
        <button mat-button>
          <mat-icon>feedback</mat-icon>
          Feedback
        </button>
      </div>
    </div>
  </section>

</div>
